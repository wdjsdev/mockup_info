/*Script Name: Mockup InfoAuthor: William DowlingBuild Date: Description: Pull up to date fabric info from central spreadsheet and return the value for the "Mockup Info" script to use.Build number: 2.0Progress:	Version 2.002		11 October, 2016		Updated fabric type to default to "See Paperwork".	Version 2.003		17 October, 2016		Revert to using the existing value for fabric textframe.		*/function getStarted(){	var docRef = app.activeDocument;	var layers = docRef.layers;		var valid = true;	//this variable holds a boolean value for whether or not fabric is fixed for this garment	//default is true;	var fabricOptions = true;	var orderNumber = layers[0].layers.getByName("Information").textFrames.getByName("Order Number").contents;	var infoOrderNumber;	var teamName;	var infoTeamName;	var initials = layers[0].layers.getByName("Information").textFrames.getByName("Mockup Initials").contents;;	var infoIntiials;	try	{		var fabricType = layers[0].layers.getByName("Information").textFrames.getByName("Fabric Type").contents;	}	catch(e)	{		fabricOptions = false;	}	var sameFabric = true;	var sameDrawstring = true;	var drawstringArtboards = [];		var curDate = getDate();		function getDate(){			var today = new Date();			var dd = today.getDate();			var mm = today.getMonth()+1; //January is 0!			var yyyy = today.getYear();			var yy = yyyy-100;			if(dd<10) {				dd='0'+dd			} 			if(mm<10) {				mm='0'+mm			} 			return mm+'.'+dd+'.'+yy;		}			//Begin ScriptUI dialog	var info = new Window("dialog", "Input Mockup Info");			//Initials		var INGroup = info.add("group");			INGroup.orientation = "column"			var text = INGroup.add("statictext", undefined, "Initials");			var INText = INGroup.add("edittext", undefined, initials.substring(0,3));				INText.active = true;				INText.characters = 5;						//Order Number				var ONGroup = info.add("group");			ONGroup.orientation = "column";			var text = ONGroup.add("statictext", undefined, "Order Number");			var ONText = ONGroup.add("edittext", undefined, orderNumber.substring(0,7));				ONText.characters = 10;					//Team Name(Customer)			var TNGroup = info.add("group");			TNGroup.orientation = "column";			var text = TNGroup.add("statictext", undefined, "Team Name(Customer)");				var TNText = TNGroup.add("edittext", undefined, orderNumber.substring(8,orderNumber.length));				TNText.characters = 30;			if(fabricOptions)		{			//Fabric Type			var FTGroup = info.add("group");				FTGroup.orientation = "column";				var inGroup = FTGroup.add("group");					var check = inGroup.add("checkbox", undefined, "Fabric is Different");				var text = FTGroup.add("statictext", undefined, "If all fabrics are the same, enter below");				var FTText = FTGroup.add("edittext", undefined, fabricType);					FTText.characters = 30;		}				//Drawstring color		var drawstring = false;		var drawstringColor;		for(var a=0;a<layers.length;a++){			try{				var draw = layers[a].layers["Information"].textFrames["Drawstring"];				drawstring = true;				drawstringArtboards.push(layers[a]);				drawstringColor = draw.contents;			}			catch(e){};		}		if(drawstring){			var DCGroup = info.add("group");				DCGroup.orientation = "column";				var inGroup = DCGroup.add("group");					var dScheck = inGroup.add("checkbox", undefined, "Different drawstring colors");				var text = DCGroup.add("statictext", undefined, "If all drawstrings are the same color, enter below");				var DCText = DCGroup.add("edittext", undefined, drawstringColor);				DCText.characters = 30;		}				//Buttons		var buttonGroup = info.add("group");			buttonGroup.add("button", undefined, "OK");			buttonGroup.add("button", undefined, "Cancel");	if(info.show() == 1){		orderNumber = ONText.text + " " + TNText.text;		initials = INText.text + " " + curDate;		if(fabricOptions)		{			fabricType = FTText.text;			if(check.value){				sameFabric = false;		}		}		if(drawstring){			drawstringColor = DCText.text;			if(dScheck.value){				sameDrawstring = false;			}		}			}	else{	valid = false;	}	//End ScriptUI dialog		//Begin Input Info onto mockups	for(var a=0;a<layers.length;a++){		var curLayer = layers[a];		if(curLayer.name != "Guides" && curLayer.name != "BKGRD, do not unlock"){			var infoLayer = curLayer.layers.getByName("Information");			var infoInitials = infoLayer.textFrames.getByName("Mockup Initials");			infoInitials.contents = initials;			var infoOrderNumber = infoLayer.textFrames.getByName("Order Number");			infoOrderNumber.contents = orderNumber;			if(fabricOptions)			{				var infoFabricType = infoLayer.textFrames.getByName("Fabric Type");				if(sameFabric){					infoFabricType.contents = fabricType;				}				else{					var thisFabric = prompt("Enter Fabric Type for style: " + curLayer.name, //						curLayer.layers.getByName("Information").textFrames.getByName("Fabric Type").contents);						infoFabricType.contents = thisFabric;				}			}			if(sameDrawstring){				for(var b=0;b<drawstringArtboards.length;b++){					var drawstringInfo = layers[drawstringArtboards[b].name].layers["Information"].textFrames["Drawstring"];					drawstringInfo.contents = DCText.text;				}			}			else if(!sameDrawstring && drawstringArtboards.length>0){				for(var b=0;b<drawstringArtboards.length;b++){					if (curLayer.name == drawstringArtboards[b].name){						var drawstringInfo = curLayer.layers["Information"].textFrames["Drawstring"];						var thisDrawstringColor = prompt("Enter drawstring color for style: " + curLayer.name, //						curLayer.layers.getByName("Information").textFrames.getByName("Drawstring").contents);						drawstringInfo.contents = thisDrawstringColor;					}				}			}		}			}			}getStarted();